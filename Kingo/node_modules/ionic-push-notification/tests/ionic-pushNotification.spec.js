(function() {
  'use strict';

  describe('Service: Push NotificationService', function () {
    var pushNotification;
    var pushMethods = {
      on: function(name, callback) {
        callback({ registrationId: 'test' });
      }
    };

    // load the controller's module
    beforeEach(module('arnaudspanneut.ionicPushNotifications', configPushProvider));

    function configPushProvider(pushNotificationProvider)Â {
      pushNotificationProvider.setConfig({
        android: { senderID: 827936081229 },
        ios: { alert: true, badge: true, sound: true },
      });
    }

    // Initialize the controller and a mock scope
    beforeEach(inject(function (_pushNotification_, $window) {
      pushNotification = _pushNotification_;
      $window.PushNotification = { init: pushNotifClass };

      function pushNotifClass(config) {
        return pushMethods;
      }
    }));

    describe('Registered', function() {
      it('should register user', inject(function($timeout) {

        expect(pushNotification.register()).equal(pushMethods);
      }));
    });

    describe('Get token id', function() {

      it('should get android id', inject(function($timeout) {
        var _data = null;

        pushNotification.register();

        pushNotification.getDeviceToken().then(function(data) {
          _data = data;
        });
        $timeout.flush();

        expect(_data).equal('test');
      }));
    });

  });
}());
